clc
clear all
close all

L=1; %Lx=Ly=Lt
n=1:16;
% e=1:18;
AA=[1 0 0; 1 (L./3) 0; 1 (L./3) (L./3)]; 
A=0.5.*det(AA);% area of each element
Tx=3;
Ty=1;
E10=[Tx.*((1./(6.*A))^.2) -Tx.*((1./(6.*A))^.2) 0; -Tx.*((1./(6.*A))^.2) Tx.*((1./(6.*A))^.2)+Ty.*((1./(6.*A))^.2) -Ty.*((1./(6.*A))^.2); 0 -Ty.*((1./(6.*A))^.2) Ty.*((1./(6.*A))^.2)];%loope over emelnet 10 as the representetive of this shape of elements
E11=[((1./(6.*A))^.2) 0 -Ty.*((1./(6.*A))^.2); 0 Tx.*((1./(6.*A))^.2) -Tx.*((1./(6.*A))^.2); -Ty.*((1./(6.*A))^.2) -Tx.*((1./(6.*A))^.2) Tx.*((1./(6.*A))^.2)+Ty.*((1./(6.*A))^.2)];%loope over emelnet 11 as the representetive of this shape of elements

k=eye(16);
k(2,1)=E10(2,1);
k(2,2)=E10(2,2)+E11(1,1)+E10(1,1);
k(2,3)=E10(2,1);
k(2,6)=E10(2,3)+E11(1,3);
k(2,7)=E10(1,3)+E11(1,2);

k(3,2)=E10(2,1);
k(3,3)=E10(2,2)+E11(1,1)+E10(1,1);
k(3,4)=E10(2,1);
k(3,7)=E10(2,3)+E11(1,3);
k(3,8)=E10(1,3)+E11(1,2);

k(6,1)=E11(2,1)+E10(3,2);
k(6,2)=E11(3,1)+E10(3,2);
k(6,5)=E10(2,1);
k(6,6)=E11(2,2)+E10(3,3)+E11(3,3)+E10(1,1)+E11(1,1)+E10(2,2);
k(6,7)=E10(2,1)+E11(3,2);
k(6,10)=E10(2,3)+E11(1,3);
k(6,11)=E10(1,3)+E11(1,2);

k(7,2)=E11(2,1)+E10(3,2);
k(7,3)=E11(3,1)+E10(3,2);
k(7,6)=E10(2,1);
k(7,7)=E11(2,2)+E10(3,3)+E11(3,3)+E10(1,1)+E11(1,1)+E10(2,2);
k(7,8)=E10(2,1)+E11(3,2);
k(7,11)=E10(2,3)+E11(1,3);
k(7,12)=E10(1,3)+E11(1,2);

k(10,5)=E11(2,1)+E10(3,2);
k(10,6)=E11(3,1)+E10(3,2);
k(10,9)=E10(2,1);
k(10,10)=E11(2,2)+E10(3,3)+E11(3,3)+E10(1,1)+E11(1,1)+E10(2,2);
k(10,11)=E10(2,1)+E11(3,2);
k(10,14)=E10(2,3)+E11(1,3);
k(10,15)=E10(1,3)+E11(1,2);

k(11,6)=E11(2,1)+E10(3,2);
k(11,7)=E11(3,1)+E10(3,2);
k(11,10)=E10(2,1);
k(11,11)=E11(2,2)+E10(3,3)+E11(3,3)+E10(1,1)+E11(1,1)+E10(2,2);
k(11,12)=E10(2,1)+E11(3,2);
k(11,15)=E10(2,3)+E11(1,3);
k(11,16)=E10(1,3)+E11(1,2);

k(14,9)=E11(2,1)+E10(3,1);
k(14,10)=E10(3,2)+E11(3,1);
k(14,13)=E11(3,2);
k(14,14)=E11(2,2)+E10(3,3)+E11(3,3);
k(14,15)=E11(3,2);

k(15,10)=E11(2,1)+E10(3,1);
k(15,11)=E10(3,2)+E11(3,1);
k(15,14)=E11(3,2);
k(15,15)=E11(2,2)+E10(3,3)+E11(3,3);
k(15,16)=E11(3,2);

h1=0;%BC on the left side
h2=1;%BC on the right side
w=1;%as a saay in HW manuscript
Q6=0;
Q11=0;


R=[h1 (w.*(A./3)) (w.*(A./3)) h2 h1 ((w.*(A./3))+Q6) (w.*(A./3)) h2 h1 (w.*(A./3)) ((w.*(A./3))+Q11) h2 h1 (w.*(A./3)) (w.*(A./3)) h2];
RR=R';
h=zeros(16,1);
h=k\RR;
hh=zeros(4);

for i=1:4;
    for j=1:4;
    hh(i,j)=h(j+((i-1).*4));
    end
end

x=1:1:4;
y=1:1:4;
[xx yy]=meshgrid(x,y); 
zz=hh;
figure;
hAxes = axes;
s = surf(xx,yy,zz,'FaceAlpha',0.5,'Parent', hAxes);
title(sprintf('Tx=%1f  Ty=%1f  Q(6)=%1f    Q(11)=%1f    h1=%1f   h2=%1f    \\psi=%1f',Tx,Ty,Q6,Q11,h1,h2,w));
colorbar
s.EdgeColor = 'none';

